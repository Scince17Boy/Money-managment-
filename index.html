<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ultra Pro Scientific Calculator</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
    :root {
        --bg-main: radial-gradient(circle at top, #0f172a, #020617 60%, #000);
        --card-bg: rgba(15, 23, 42, 0.92);
        --card-border: rgba(148, 163, 184, 0.35);
        --accent: #38bdf8;
        --accent-soft: rgba(56, 189, 248, 0.2);
        --text-main: #e5e7eb;
        --text-soft: #9ca3af;
        --btn-bg: #1f2937;
        --btn-bg-strong: #111827;
        --btn-op: #38bdf8;
        --btn-eq: #22c55e;
        --shadow-main: 0 20px 40px rgba(0,0,0,0.6);
    }

    body.light {
        --bg-main: radial-gradient(circle at top, #e0f2fe, #f9fafb 60%, #e5e7eb);
        --card-bg: rgba(255, 255, 255, 0.96);
        --card-border: rgba(148, 163, 184, 0.5);
        --accent: #0ea5e9;
        --accent-soft: rgba(14, 165, 233, 0.1);
        --text-main: #020617;
        --text-soft: #64748b;
        --btn-bg: #e5e7eb;
        --btn-bg-strong: #d1d5db;
        --btn-op: #0ea5e9;
        --btn-eq: #22c55e;
        --shadow-main: 0 18px 35px rgba(15,23,42,0.25);
    }

    * {
        box-sizing: border-box;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
        margin: 0;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--bg-main);
        color: var(--text-main);
        padding: 10px;
        transition: background 0.4s ease;
    }

    .app {
        max-width: 900px;
        width: 100%;
        display: grid;
        grid-template-columns: 3fr 2fr;
        gap: 14px;
    }

    @media (max-width: 768px) {
        .app {
            grid-template-columns: 1fr;
        }
    }

    .card {
        background: var(--card-bg);
        border-radius: 18px;
        padding: 16px 16px 18px;
        border: 1px solid var(--card-border);
        box-shadow: var(--shadow-main);
        backdrop-filter: blur(14px);
    }

    .header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 10px;
    }

    .title-block {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .logo {
        width: 34px;
        height: 34px;
        border-radius: 999px;
        padding: 2px;
        background: conic-gradient(from 180deg, #22c55e, #38bdf8, #6366f1, #ec4899, #22c55e);
    }

    .logo-inner {
        width: 100%;
        height: 100%;
        border-radius: inherit;
        background: #020617;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.85rem;
        font-weight: 700;
        color: #e5e7eb;
    }

    body.light .logo-inner {
        background: #f9fafb;
        color: #0f172a;
    }

    .title-main {
        font-size: 0.95rem;
        font-weight: 700;
    }

    .title-sub {
        font-size: 0.75rem;
        color: var(--text-soft);
    }

    .chip {
        font-size: 0.7rem;
        padding: 4px 10px;
        border-radius: 999px;
        background: var(--accent-soft);
        border: 1px solid var(--accent);
        display: inline-flex;
        align-items: center;
        gap: 6px;
    }

    .chip-dot {
        width: 7px;
        height: 7px;
        border-radius: 999px;
        background: #22c55e;
    }

    .theme-toggle {
        border-radius: 999px;
        border: 1px solid var(--card-border);
        background: var(--btn-bg);
        font-size: 0.75rem;
        padding: 5px 10px;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 6px;
        color: var(--text-soft);
    }

    .display-wrapper {
        margin-bottom: 10px;
        border-radius: 14px;
        padding: 10px 10px 8px;
        background: radial-gradient(circle at top left, rgba(56,189,248,0.1), transparent 60%);
        border: 1px solid rgba(148, 163, 184, 0.4);
    }

    .display-top {
        font-size: 0.8rem;
        min-height: 18px;
        opacity: 0.8;
        text-align: right;
        word-wrap: break-word;
    }

    .display-main {
        margin-top: 4px;
        font-size: 1.9rem;
        text-align: right;
        font-weight: 600;
        letter-spacing: 0.03em;
        overflow-x: auto;
        white-space: nowrap;
    }

    .mode-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin: 4px 0 2px;
        font-size: 0.75rem;
        color: var(--text-soft);
    }

    .tabs {
        display: inline-flex;
        border-radius: 999px;
        padding: 2px;
        background: var(--btn-bg-strong);
    }

    .tab {
        font-size: 0.7rem;
        padding: 3px 10px;
        border-radius: 999px;
        cursor: pointer;
        opacity: 0.7;
    }

    .tab.active {
        background: var(--accent);
        color: #020617;
        opacity: 1;
        font-weight: 600;
    }

    .keys {
        display: grid;
        grid-template-columns: repeat(5, minmax(0, 1fr));
        gap: 8px;
        margin-top: 8px;
    }

    .btn {
        padding: 10px 0;
        font-size: 0.9rem;
        border-radius: 11px;
        border: none;
        background: var(--btn-bg);
        color: var(--text-main);
        cursor: pointer;
        box-shadow: 0 7px 16px rgba(15,23,42,0.7);
        transition: transform 0.08s ease, box-shadow 0.12s ease, background 0.12s ease, opacity 0.12s ease;
    }

    .btn:active {
        transform: translateY(1px) scale(0.98);
        box-shadow: 0 2px 8px rgba(15,23,42,0.7);
    }

    .btn-soft {
        background: var(--btn-bg-strong);
        color: var(--text-soft);
    }

    .btn-op {
        background: var(--btn-op);
        color: #020617;
        font-weight: 700;
    }

    .btn-eq {
        background: linear-gradient(135deg, #22c55e, #16a34a);
        color: #f9fafb;
        font-weight: 700;
    }

    .btn-wide {
        grid-column: span 2;
    }

    .btn-pill {
        border-radius: 999px;
    }

    /* History panel */
    .history-card-title {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 6px;
    }

    .history-title {
        font-size: 0.85rem;
        font-weight: 600;
    }

    .history-clear {
        font-size: 0.7rem;
        border-radius: 999px;
        border: 1px solid var(--card-border);
        background: transparent;
        padding: 3px 8px;
        color: var(--text-soft);
        cursor: pointer;
    }

    .history-list {
        max-height: 290px;
        overflow-y: auto;
        padding-right: 4px;
        font-size: 0.8rem;
    }

    .history-item {
        padding: 6px 6px 5px;
        border-radius: 10px;
        margin-bottom: 6px;
        background: rgba(15,23,42,0.8);
        border: 1px solid rgba(148,163,184,0.2);
        cursor: pointer;
    }

    body.light .history-item {
        background: rgba(241,245,249,0.9);
    }

    .history-expr {
        opacity: 0.8;
    }

    .history-result {
        font-weight: 600;
        font-size: 0.9rem;
        text-align: right;
    }

    .tag-row {
        font-size: 0.7rem;
        color: var(--text-soft);
        margin-top: 4px;
        display: flex;
        justify-content: space-between;
    }

    .tag-small {
        padding: 2px 6px;
        border-radius: 999px;
        background: rgba(148,163,184,0.2);
    }

    ::-webkit-scrollbar {
        width: 5px;
    }
    ::-webkit-scrollbar-thumb {
        background: rgba(148,163,184,0.6);
        border-radius: 999px;
    }
</style>
</head>
<body class="dark">

<div class="app">
    <!-- Main Calculator -->
    <div class="card">
        <div class="header">
            <div class="title-block">
                <div class="logo">
                    <div class="logo-inner">SC</div>
                </div>
                <div>
                    <div class="title-main">Ultra Scientific</div>
                    <div class="title-sub">Advanced JS Calculator ‚Ä¢ v1.0</div>
                </div>
            </div>
            <div style="display:flex; gap:8px; align-items:center;">
                <div class="chip">
                    <span class="chip-dot"></span>
                    <span id="angleModeLabel">DEG</span>
                </div>
                <button class="theme-toggle" onclick="toggleTheme()">
                    <span id="themeIcon">üåô</span><span id="themeText">Dark</span>
                </button>
            </div>
        </div>

        <div class="display-wrapper">
            <div class="display-top" id="expressionDisplay"></div>
            <div class="display-main" id="mainDisplay">0</div>
            <div class="mode-row">
                <div>Memory: <span id="memoryLabel">M: 0</span></div>
                <div class="tabs">
                    <div class="tab active" id="degTab" onclick="setAngleMode('DEG')">DEG</div>
                    <div class="tab" id="radTab" onclick="setAngleMode('RAD')">RAD</div>
                </div>
            </div>
        </div>

        <div class="keys">
            <button class="btn btn-soft" onclick="clearAll()">AC</button>
            <button class="btn btn-soft" onclick="deleteChar()">DEL</button>
            <button class="btn btn-soft" onclick="insert('(')">(</button>
            <button class="btn btn-soft" onclick="insert(')')">)</button>
            <button class="btn btn-soft" onclick="insert('%')">%</button>

            <button class="btn btn-soft" onclick="applyFunc('sin')">sin</button>
            <button class="btn btn-soft" onclick="applyFunc('cos')">cos</button>
            <button class="btn btn-soft" onclick="applyFunc('tan')">tan</button>
            <button class="btn btn-soft" onclick="applyFunc('log')">log</button>
            <button class="btn btn-soft" onclick="applyFunc('ln')">ln</button>

            <button class="btn" onclick="insert('7')">7</button>
            <button class="btn" onclick="insert('8')">8</button>
            <button class="btn" onclick="insert('9')">9</button>
            <button class="btn btn-op" onclick="insert('/')">√∑</button>
            <button class="btn btn-soft" onclick="applyFunc('sqrt')">‚àö</button>

            <button class="btn" onclick="insert('4')">4</button>
            <button class="btn" onclick="insert('5')">5</button>
            <button class="btn" onclick="insert('6')">6</button>
            <button class="btn btn-op" onclick="insert('*')">√ó</button>
            <button class="btn btn-soft" onclick="insert('^')">x ∏</button>

            <button class="btn" onclick="insert('1')">1</button>
            <button class="btn" onclick="insert('2')">2</button>
            <button class="btn" onclick="insert('3')">3</button>
            <button class="btn btn-op" onclick="insert('-')">‚àí</button>
            <button class="btn btn-soft" onclick="insertConstant('œÄ')">œÄ</button>

            <button class="btn btn-wide" onclick="insert('0')">0</button>
            <button class="btn" onclick="insert('.')">.</button>
            <button class="btn btn-op" onclick="insert('+')">+</button>
            <button class="btn btn-soft" onclick="insertConstant('e')">e</button>
            <button class="btn btn-eq btn-pill" onclick="calculate()">=</button>

            <!-- Memory Row -->
            <button class="btn btn-soft btn-wide" onclick="memoryClear()">MC</button>
            <button class="btn btn-soft" onclick="memoryPlus()">M+</button>
            <button class="btn btn-soft" onclick="memoryMinus()">M-</button>
            <button class="btn btn-soft btn-wide" onclick="useMemory()">MR</button>
        </div>
    </div>

    <!-- History Panel -->
    <div class="card">
        <div class="history-card-title">
            <div>
                <div class="history-title">History</div>
                <div style="font-size:0.75rem; color:var(--text-soft);">Tap an item to reuse expression</div>
            </div>
            <button class="history-clear" onclick="clearHistory()">Clear</button>
        </div>

        <div class="history-list" id="historyList">
            <!-- History items injected here -->
        </div>

        <div class="tag-row">
            <div class="tag-small">Mode: <span id="historyAngle">DEG</span></div>
            <div class="tag-small">Theme: <span id="historyTheme">Dark</span></div>
        </div>
    </div>
</div>

<script>
    const mainDisplay = document.getElementById('mainDisplay');
    const expressionDisplay = document.getElementById('expressionDisplay');
    const memoryLabel = document.getElementById('memoryLabel');
    const historyList = document.getElementById('historyList');
    const angleModeLabel = document.getElementById('angleModeLabel');
    const historyAngle = document.getElementById('historyAngle');
    const historyTheme = document.getElementById('historyTheme');
    const themeIcon = document.getElementById('themeIcon');
    const themeText = document.getElementById('themeText');

    let currentExpression = '';
    let memory = 0;
    let angleMode = 'DEG'; // or 'RAD'
    let history = [];

    function updateDisplays() {
        expressionDisplay.textContent = currentExpression;
        if (currentExpression === '') {
            mainDisplay.textContent = '0';
        }
    }

    function insert(value) {
        currentExpression += value;
        mainDisplay.textContent = currentExpression;
        expressionDisplay.textContent = currentExpression;
    }

    function insertConstant(symbol) {
        if (symbol === 'œÄ') {
            currentExpression += 'œÄ';
        } else if (symbol === 'e') {
            currentExpression += 'e';
        }
        mainDisplay.textContent = currentExpression;
        expressionDisplay.textContent = currentExpression;
    }

    function clearAll() {
        currentExpression = '';
        mainDisplay.textContent = '0';
        expressionDisplay.textContent = '';
    }

    function deleteChar() {
        currentExpression = currentExpression.slice(0, -1);
        if (currentExpression === '') {
            mainDisplay.textContent = '0';
            expressionDisplay.textContent = '';
        } else {
            mainDisplay.textContent = currentExpression;
            expressionDisplay.textContent = currentExpression;
        }
    }

    function applyFunc(funcName) {
        // Use the current displayed value as input for function
        let value = parseFloat(mainDisplay.textContent);
        if (isNaN(value)) return;

        if (['sin','cos','tan'].includes(funcName)) {
            if (angleMode === 'DEG') {
                value = value * (Math.PI / 180);
            }
        }

        let result;
        switch (funcName) {
            case 'sin': result = Math.sin(value); break;
            case 'cos': result = Math.cos(value); break;
            case 'tan': result = Math.tan(value); break;
            case 'log': result = Math.log10(value); break;
            case 'ln': result = Math.log(value); break;
            case 'sqrt': result = Math.sqrt(value); break;
            default: return;
        }

        currentExpression = String(result);
        mainDisplay.textContent = currentExpression;
        expressionDisplay.textContent = funcName + '(' + (angleMode === 'DEG' && ['sin','cos','tan'].includes(funcName) ? 'deg ' : '') + value.toFixed(4) + ')';
        addHistory(funcName + '(' + mainDisplay.textContent + ')', result);
    }

    function calculate() {
        if (!currentExpression) return;

        let expr = currentExpression;

        // Replace constants
        expr = expr.replace(/œÄ/g, Math.PI.toString());
        expr = expr.replace(/e/g, Math.E.toString());

        // Replace ^ with **
        expr = expr.replace(/\^/g, '**');

        // Simple security: only allowed chars
        if (!/^[0-9+\-*/().%eœÄ\s**]+$/i.test(currentExpression.replace(/[œÄe]/g,''))) {
            mainDisplay.textContent = 'Error';
            return;
        }

        try {
            const result = eval(expr);
            addHistory(currentExpression, result);
            currentExpression = String(result);
            mainDisplay.textContent = currentExpression;
            expressionDisplay.textContent = '';
        } catch (e) {
            mainDisplay.textContent = 'Error';
        }
    }

    // Memory functions
    function memoryPlus() {
        const val = parseFloat(mainDisplay.textContent);
        if (!isNaN(val)) {
            memory += val;
            updateMemoryLabel();
        }
    }

    function memoryMinus() {
        const val = parseFloat(mainDisplay.textContent);
        if (!isNaN(val)) {
            memory -= val;
            updateMemoryLabel();
        }
    }

    function memoryClear() {
        memory = 0;
        updateMemoryLabel();
    }

    function useMemory() {
        currentExpression += memory.toString();
        mainDisplay.textContent = currentExpression;
        expressionDisplay.textContent = currentExpression;
    }

    function updateMemoryLabel() {
        memoryLabel.textContent = 'M: ' + memory.toFixed(2);
    }

    // Angle mode
    function setAngleMode(mode) {
        angleMode = mode;
        angleModeLabel.textContent = mode;
        historyAngle.textContent = mode;

        document.getElementById('degTab').classList.toggle('active', mode === 'DEG');
        document.getElementById('radTab').classList.toggle('active', mode === 'RAD');
    }

    // History
    function addHistory(expr, result) {
        history.unshift({ expr, result });
        if (history.length > 50) history.pop();
        renderHistory();
    }

    function renderHistory() {
        historyList.innerHTML = '';
        history.forEach((item, index) => {
            const div = document.createElement('div');
            div.className = 'history-item';
            div.onclick = () => {
                currentExpression = String(item.result);
                mainDisplay.textContent = currentExpression;
                expressionDisplay.textContent = item.expr;
            };
            div.innerHTML = `
                <div class="history-expr">${item.expr}</div>
                <div class="history-result">= ${Number(item.result).toPrecision(6)}</div>
            `;
            historyList.appendChild(div);
        });
    }

    function clearHistory() {
        history = [];
        renderHistory();
    }

    // Theme toggle
    function toggleTheme() {
        const body = document.body;
        const isDark = body.classList.contains('dark');
        if (isDark) {
            body.classList.remove('dark');
            body.classList.add('light');
            themeIcon.textContent = '‚òÄÔ∏è';
            themeText.textContent = 'Light';
            historyTheme.textContent = 'Light';
        } else {
            body.classList.remove('light');
            body.classList.add('dark');
            themeIcon.textContent = 'üåô';
            themeText.textContent = 'Dark';
            historyTheme.textContent = 'Dark';
        }
    }

    // Init
    document.body.classList.add('dark');
    updateDisplays();
    updateMemoryLabel();
</script>

</body>
</html>
